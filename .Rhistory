summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
plot(unlist(fc_AR1), type = "l")
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
#The all-important ARIMA/ARCH/GARCH fittings
#method 1
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE, xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
plot(unlist(fc_AR1), type = "l")
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
#method 2
reg1 <- model.matrix(~ GDP + abs + factor + weekends, data = elec_frame)
fit_AR1 <- auto.arima(elec_frame$log[train], xreg = reg1[train,], stepwise = FALSE, stationary = FALSE, seasonal = FALSE, allowmean = TRUE)
forecast::ndiffs(elec_frame$log[train])
#method 1
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE, xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
plot(unlist(fc_AR1), type = "l")
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = FALSE, seasonal = FALSE, allowmean = TRUE, xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
plot(unlist(fc_AR1), type = "l")
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
#method 2
reg1 <- model.matrix(~ GDP + abs + factor + weekends, data = elec_frame)
fit_AR1 <- auto.arima(elec_frame$log[train], xreg = reg1[train,], stepwise = FALSE, stationary = FALSE, seasonal = FALSE, allowmean = TRUE)
REG1
reg1
reg21 <- model.matrix(~ GDP + abs + factor, data = elec_frame)  # Remove weekends
fit_test <- auto.arima(elec_frame$log[train], xreg = reg21[train,], stationary = FALSE)
reg21 <- model.matrix(~ GDP + abs, data = elec_frame)  # Remove weekends
fit_test <- auto.arima(elec_frame$log[train], xreg = reg21[train,], stationary = FALSE)
View(fit_test)
summary(fit_test)
fit_AR1 <- arima(elec_frame$log[train], xreg = reg1[train,], order = c(3, 1, 2))
fit_AR1 <- arima(elec_frame$log[train], xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]), order = c(3, 1, 2))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
reg1 <- model.matrix(~ GDP + abs + factor + weekends, data = elec_frame)
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE, xreg = reg1)
summary(fit_AR1)
fc_AR1 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg1[1:(i-1),], model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = reg1[i,,drop = FALSE])
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE, xreg = reg1[train])
summary(fit_AR1)
fc_AR1 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg1[1:(i-1),], model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = reg1[i,,drop = FALSE])
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = FALSE, seasonal = FALSE, allowmean = TRUE, xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fc_year1 <- forecast(fc_AR1, h = 365, xreg = reg1[valid,,drop = FALSE])
fc_year1 <- forecast(fc_AR1, h = 365, xreg = cbind(elec_frame$GDP[valid], elec_frame$abs[valid], elec_frame$factor[valid], elec_frame$weekends[valid]))
summary(SARIMA12)
summary(fit_SAR12)
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = FALSE, seasonal = TRUE, allowmean = TRUE, xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
MAPE(exp(unlist(fc_AR1)), )
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
acf(residuals(fit_AR1))
summary(fit_AR1)
reg1 <- model.matrix(~ GDP + abs + factor + weekends, data = elec_frame)
fit_AR1 <- auto.arima(max.order = 10, elec_frame$log[train], xreg = reg1[train,], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE)
summary(fit_AR1)
fc_AR1 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg1[1:(i-1),], model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = reg1[i,,drop = FALSE])
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = FALSE, seasonal = FALSE, allowmean = TRUE, xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fc_year2 <- forecast(temp_obj, h = 365, xreg = cbind(elec_frame$GDP[valid], elec_frame$abs[valid], elec_frame$factor[valid], elec_frame$weekends[valid]))
plot(fc_year2)
coef(fit_AR2)
fit_AR1 <- auto.arima(elec_frame$log[train], stepwise = FALSE, stationary = FALSE, seasonal = FALSE, allowmean = TRUE, xreg = cbind(elec_frame$GDP[train], elec_frame$abs[train], elec_frame$factor[train], elec_frame$weekends[train]))
fc_AR1 <- numeric(365)
summary(fit_AR1)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = cbind(elec_frame$GDP[1:(i-1)], elec_frame$abs[1:(i-1)], elec_frame$factor[1:(i-1)], elec_frame$weekends[1:(i-1)]), model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = cbind(elec_frame$GDP[i], elec_frame$abs[i], elec_frame$factor[i], elec_frame$weekends[i]))
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
acf(residuals(fit_AR1))
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fc_year2 <- forecast(fit_AR1, h = 365, xreg = cbind(elec_frame$GDP[valid], elec_frame$abs[valid], elec_frame$factor[valid], elec_frame$weekends[valid]))
plot(fc_year2)
summary(fit_SAR12)
acf(residuals(fit_SAR12))
pacf(residuals(fit_SAR12))
acf(residuals(fit_SAR12))
fc_SAR12 <- numeric(365)
adf.test(residuals(fit_SAR12))
Box.test(residuals(fit_SAR12))
Box.test(residuals(fit_AR2))
adf.test(residuals(fit_AR2))
Box.test(residuals(fit_AR2), lag = 8)
Box.test(residuals(fit_AR2), lag = 3)
Box.test(residuals(fit_SAR12), lag = 7)
#reg12
reg12 <- model.matrix(~ (GDP + abs + factor + weekends)^2 - GDP:weekends, data = elec_frame)
for(i in 1:10) {garch12 <- ugarchspec(
mean.model = list(armaOrder = c(i, 0), include.mean = TRUE, archm = FALSE, archpow = 1, arfima = FALSE, external.regressors = reg12[, -1], archex = FALSE)
)
garchfit12 <- ugarchfit(garch12, elec_frame$log, out.sample = 731)
print(infocriteria(garchfit12))
}
#p= 10 AIC = -4.462264
garch12 <- ugarchspec(
mean.model = list(armaOrder = c(10, 0), include.mean = TRUE, archm = FALSE, archpow = 1, arfima = FALSE, external.regressors = reg12[, -1], archex = FALSE)
)
garchfit12 <- ugarchfit(garch12, elec_frame$log, out.sample = 731)
garchfor12 <- t(fitted(
ugarchforecast(garchfit12, n.ahead = 1, n.roll = 364, external.forecasts = list(mregfor = reg12[valid,-1]))
))
MAPE(exp(garchfor12), elec_frame$max_MW[valid]) #1.980%
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(garchfor12))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
residuals(linear1)
plot(residuals(linear1))
plot(residuals(linear2))
plot(residuals(linear12))
plot(residuals(fit_AR1))
plot(residuals(fit_SAR1))
plot(residuals(garchfit12))
residuls(garchfit12)
residuals(garchfit12)
reg1 <- model.matrix(~ GDP + abs + factor + weekends, data = elec_frame)
fit_AR1 <- auto.arima(max.order = 10, elec_frame$log[train], xreg = reg1[train,], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE)
summary(fit_AR1)
fc_AR1 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg1[1:(i-1),], model = fit_AR1)
fc <- forecast(temp_obj, h = 1, xreg = reg1[i,,drop = FALSE])
fc_AR1[i - NROW(train)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_AR1)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR1)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
reg2 <- model.matrix(~ GDP + abs + factor*weekends, data = elec_frame)
fit_AR2 <- auto.arima(max.order = 10, elec_frame$log[train], xreg = reg2[train,], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE)
fc_AR2 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg2[1:(i-1),], model = fit_AR2)
fc <- forecast(temp_obj, h = 1, xreg = reg2[i,,drop = FALSE])
fc_AR2[i - NROW(train)] <- fc$mean[1]
}
plot(unlist(fc_AR2), type = "l")
MAPE(exp(unlist(fc_AR2)), elec_frame$max_MW[valid])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(unlist(fc_AR2)))) +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
fc_year2 <- forecast(temp_obj, h = 365, xreg = reg2[valid,,drop = FALSE])
plot(fc_year2)
coef(fit_AR2)
summary(fit_AR2)
reg12 <- model.matrix(~ (GDP + abs + factor + weekends)^2 - GDP:weekends, data = elec_frame)
fit_AR12 <- auto.arima(elec_frame$log[train], xreg = reg12[train,], stepwise = FALSE, stationary = TRUE, seasonal = FALSE, allowmean = TRUE)
fc_AR12 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg12[1:(i-1),], model = fit_AR12)
fc <- forecast(temp_obj, h = 1, xreg = reg12[i,,drop = FALSE])
fc_AR12[i - NROW(train)] <- fc$mean[1]
}
summary(fit_AR12)
MAPE(exp(unlist(fc_AR12)), elec_frame$max_MW[valid])
acf(elec_frame$log[train])
pacf(elec_frame$log[train])
fit_SAR1 <- auto.arima(
ts(elec_frame$log[train], frequency = 7), max.order = 10, xreg = reg1[train,], seasonal = TRUE, stepwise = FALSE, stationary = TRUE, allowmean = TRUE
)
summary(fit_SAR1)
acf(residuals(fit_SAR1))
pacf(residuals(fit_SAR1))
fc_SAR1 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg1[1:(i-1),], model = fit_SAR1)
fc <- forecast(temp_obj, h = 1, xreg = reg1[i,,drop = FALSE])
fc_SAR1[i - NROW(train)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_SAR1)), elec_frame$max_MW[valid])
summary(fit_SAR2)
MAPE(exp(unlist(fc_SAR2)), elec_frame$max_MW[valid])
fit_SAR12 <- auto.arima(
ts(elec_frame$log[train], frequency = 7), max.order = 10, xreg = reg12[train,], seasonal = TRUE, stepwise = FALSE, stationary = TRUE, allowmean = TRUE
)
summary(fit_SAR12)
fc_SAR12 <- numeric(365)
for(i in valid) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg12[1:(i-1),], model = fit_SAR12)
fc <- forecast(temp_obj, h = 1, xreg = reg12[i,,drop = FALSE])
fc_SAR12[i - NROW(train)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_SAR12)), elec_frame$max_MW[valid])
garchfit12 <- ugarchspec(
mean.model = list(armaOrder = c(10, 0), include.mean = TRUE, archm = FALSE, archpow = 1, arfima = FALSE, external.regressors = reg12[, -1], archex = FALSE)
)
garchfit12 <- ugarchfit(garch12, elec_frame$log, out.sample = 731)
garchfit12
-4.4625*2922
MAPE(exp(garchfor12), elec_frame$max_MW[valid]) #1.980%
-4.232781*2922
-4.401347*2922
-4.4625*2922
AIC(linear1)
AIC(linear2)
AIC(linear12)
#Fitting
MAPE(exp(predict(linear1, elec_frame[valid,])), elec_frame$max_MW[valid])
MAPE(exp(predict(linear2, elec_frame[valid,])), elec_frame$max_MW[valid])
MAPE(exp(predict(linear12, elec_frame[valid,])), elec_frame$max_MW[valid])
residuals(garchfit1)
acf(residuals(garchfit1))
resid_lm <- residuals(linear12)
acf(resid_lm)
resid_ar <- residuals(fit_AR12)
acf(resid_ar)
resid_sar <- residuals(fit_SAR12)
acf(resid_sar)
resid_garch <- residuals(garchfit12)
View(resid_garch)
resid_garch[,1]
acf(resid_garch)
as.vector(resid_garch)
resid_garch <- as.vector(residuals(garchfit12))
acf(resid_garch)
acf(resid_sar)
acf(resid_garch)
acf(resid_sar)
acf(resid_ar)
acf(resid_lm)
acf(resid_sar)
acf(resid_garch)
acf(resid_sar)
acf(resid_ar)
acf(resid_lm)
resid_ar
resid_sar
resid_sar <- ts(residuals(fit_SAR12), frequency = 1)
acf(resid_sar)
resid_garch <- as.vector(residuals(garchfit12))
acf(resid_garch)
acf(resid_ar)
acf(resid_lm)
linear_test <- lm(log ~ (GDP + abs)^2, data = elec_frame[train,])
ggplot(data = elec_frame[valid,]) +
geom_line(mapping = aes(x = 1:365, y = exp(predict(linear_test, elec_frame[valid,]))), colour = 'blue') +
geom_line(mapping = aes(x = 1:365, y = max_MW), colour = 'red')
MAPE(exp(predict(linear_test, elec_frame[valid,])), elec_frame$max_MW[valid])
acf(resid_lm)
acf(resid_ar)
summary(fit_AR12)
summary(fit_SAR12)
plot(resid_sar)
plot(resid_garch)
plot(resid_garch, type = "l")
plot(resid_sar)
acf(resid_ar)
acf(resid_sar)
acf(resid_garch)
acf(resid_sar)
acf(resid_ar)
acf(resid_lm)
acf(resid_ar)
acf(resid_sar)
Box.test(resid_lm, lag = 7)
Box.test(resid_ar, lag = 7)
Box.test(resid_sar, lag = 7)
Box.test(resid_garch, lag = 7)
Box.test(resid_sar, lag = 8)
Box.test(resid_garch, lag = 8)
Box.test(resid_lm, lag = 7, "Ljung-Box")
Box.test(resid_ar, lag = 7, "Ljung-Box")
Box.test(resid_sar, lag = 7, "Ljung-Box")
Box.test(resid_garch, lag = 7, "Ljung-Box")
base_hw <- dshw(elec_frame$log[train], period1 = 7, period2 = 364)
plot(base_hw)
plot(forecast(base_hw, h = 365))
base_hw$mean[valid]
base_hw$mean[1:731]
base_hw <- dshw(elec_frame$log[train], period1 = 7, period2 = 364, h = 731)
fc_HW = numeric(366)
for(i in test) {
temp_obj <- dshw(elec_frame$log[1:i-1], period1 = 7, period2 = 364, model = base_hw)
fc <- forecast(temp_obj, h = 1)
fc_HW[i - NROW(train) - NROW(valid)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_HW)), elec_frame$max_MW[test])
summary(base_hw)
MAPE(exp(unlist(fc_HW)), elec_frame$max_MW[test])
MAPE(exp(predict(linear12, elec_frame[test,])), elec_frame$max_MW[test])
for(i in test) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg12[1:(i-1),], model = fit_AR12)
fc <- forecast(temp_obj, h = 1, xreg = reg12[i,,drop = FALSE])
fc_AR12[i - NROW(train) - NROW(valid)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_AR12)), elec_frame$max_MW[test])
fc_SAR12_test <- numeric(366)
for(i in test) {
temp_obj <- Arima(elec_frame$log[1:(i-1)], xreg = reg12[1:(i-1),], model = fit_SAR12)
fc <- forecast(temp_obj, h = 1, xreg = reg12[i,,drop = FALSE])
fc_SAR12_test[i - NROW(train) - NROW(valid)] <- fc$mean[1]
}
MAPE(exp(unlist(fc_SAR12_test)), elec_frame$max_MW[test])
garchfor12 <- t(fitted(
ugarchforecast(garchfit12, n.ahead = 1, n.roll = 730, external.forecasts = list(mregfor = reg12[2923:3653,-1]))
))
garchfor12
MAPE(exp(garchfor12[366:731]), elec_frame$max_MW[test]) #valid 1.969%, test
#AR(8)-GARCH(1, 1)
reg_test <- model.matrix(~ abs + factor + weekends, data = elec_frame)
#AR(8)-GARCH(1, 1)
reg_base <- model.matrix(~ abs + factor + weekends, data = elec_frame)
garch_base <- ugarchspec(
mean.model = list(armaOrder = c(8, 0), include.mean = TRUE, archm = FALSE, archpow = 1, arfima = FALSE, external.regressors = reg_base[, -1], archex = FALSE)
)
fit_base <- ugarchfit(garch_base, elec_frame$log, out.sample = 731)
garchfor_base <- t(fitted(
ugarchforecast(fit_base, n.ahead = 1, n.roll = 730, external.forecasts = list(mregfor = reg_base[2923:3653,-1]))
))
MAPE(exp(garchfor_base[366:731]), elec_frame$max_MW[test])
adf.test(resid_sar)
adf.test(resid_ar)
adf.test(resid_lm)
adf.test(resid_sar)
ggplot(data = elec_frame[test,]) +
geom_line(mapping = aes(x = 1:366, y = exp(unlist(test_SAR12)))) +
geom_line(mapping = aes(x = 1:366, y = max_MW), colour = 'red')
plot(elec_frame$max_MW[1:731], type = "l")
ggplot() +
geom_line(aes(x = date_vector <- seq(as.Date("2015-01-01"), as.Date("2016-12-31"), by = "day"), y = elec_frame$max_MW[1:731]))
ggplot() +
geom_line(aes(x = date_vector <- seq(as.Date("2015-01-01"), as.Date("2016-12-31"), by = "day"), y = elec_frame$max_MW[1:731])) +
xlab("Date") + ylab("전력(MW)")
plot(decomp)
elec_train <- elec_frame[train,]
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_frame$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_frame$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)')
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_train$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_train$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)')
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_train$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_train$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)') + legend(x = "Weekday", y = "Weekend")
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_train$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_train$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)') + legend(x = "bottomleft" )
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_train$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_train$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)') + legend(x = "bottomleft", legend = c("weekday", "weekend"))
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_train$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_train$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)') + legend(-3, -3, legend = c("weekday", "weekend"))
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_train$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_train$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)') + theme(legend.text = c("weekday", "weekend"))
ggplot() +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekday")], y = elec_train$log[(elec_train$weekends == "Weekday")])) +
geom_point(mapping = aes(x = elec_train$temp[(elec_train$weekends == "Weekend")], y = elec_train$log[(elec_train$weekends == "Weekend")]), color = 'red') +
xlab('temperature') + ylab('log(demand)')
View(elec_train)
ggplot(elec_train, aes(temp, log)) +
geom_point(mapping = aes(color = weekends)) +
xlab('temperature') + ylab('log(demand)')
boxplot(max_MW ~ weekends*factor, data = elec_frame[train,])
acf(resid_lm)
acf(resid_ar)
acf(resid_sar)
acf(resid_garch)
summary(fit_SAR12)
ggplot(data = elec_frame[test,]) +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = exp(unlist(test_SAR12)))) +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = max_MW), colour = 'red')
ggplot(data = elec_frame[test,]) +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = exp(unlist(test_SAR12)))) +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = max_MW), colour = 'red') +
xlab("date") + ylab("전력(MW)")
ggplot(data = elec_frame[test,]) +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = max_MW)) +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = exp(unlist(test_SAR12))), colour = 'red') +
xlab("Date") + ylab("전력(MW)")
ggplot(data = elec_frame[test,]) +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = exp(unlist(test_SAR12))), colour = 'red') +
geom_line(mapping = aes(x = seq(as.Date("2024-01-01"), as.Date("2024-12-31"), by = "day"), y = max_MW)) +
xlab("Date") + ylab("전력(MW)")
overfit_AR12 <- arima(elec_frame$log[train], order = c(4, 0, 1) , xreg = reg12[train,])
overfit_SAR12 <- arima(ts(elec_frame$log[train], frequency = 7), order = c(5, 0, 3), seasonal = c(2, 0, 0), xreg = reg12[train,])
View(reg12)
overfit_SAR12 <- arima(ts(elec_frame$log[train], frequency = 7), order = c(5, 0, 3), seasonal = c(2, 0, 0), xreg = reg12[train,2:14])
summary(overfit_SAR12)
summary(fit_SAR12)
overfit_SAR12
fit_SAR12
overfit_AR12 <- arima(elec_frame$log[train], order = c(4, 0, 1) , xreg = reg12[train,2:14])
overfit_AR12_2 <- arima(elec_frame$log[train], order = c(3, 0, 2) , xreg = reg12[train,2:14])
overfit_AR12
overfit_AR12_2
summary(fit_AR12)
fit_AR12
overfit_SAR12_2 <- arima(ts(elec_frame$log[train], frequency = 7), order = c(4, 0, 4), seasonal = c(2, 0, 0), xreg = reg12[train,2:14])
overfit_SAR12_2
decomp <- mstl(msts(elec_frame$max_MW[train], c(7, 365)))
library(forecast)
decomp <- mstl(msts(elec_frame$max_MW[train], c(7, 365)))
plot(decomp)
